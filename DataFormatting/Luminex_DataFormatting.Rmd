---
title: "Luminex_DataFormatting"
author: "Elise Viox"
date: "October 28, 2018"
output: pdf_document
---
 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE)
```
##R Markdown
#Format Data
I wrote this script to format Luminex raw data in an "R friendly" format. I originally started with the Luminex raw data summary tab file generated by MagPix software. I created a new header for the table that combined cytokine names with their respective units of concentration, removed "unknown" sample entries from the table, and renamed the "Analyte..Sample" column to "Sample." For analyte concentrations below and above the limit of detection, I removed the special characters "<|>|↓"" in the cells. Therefore, concentrations that exceeded the upper limit of detection will now read as being the value of the upper limit and concentrations that were below the lower limit of detection will now read as being the lower limit.
##Load Data
```{r Load Data}

setwd("/Users/eviox/Documents/Emory_IMP/Rotations/Day_Lab")
test<-read.csv("Luminex_Practice.csv", header=TRUE, skip=4, sep=",")
```

##Combine Cytokine name with units of concentration for new column names
```{r Make New Header}
n <- names(test)
row1 <- as.matrix (test[1,])
new_head<- paste(n, row1, sep= "_")
colnames(test)<- (c(new_head))
```

##Find "Unknown" analyte sample entries, remove row from data set 
```{r Remove Empty Well Entries}
test$Analyte..Sample_[grepl("Unknown",test$Analyte..Sample_)]<-""
```

##Rename "Analyte..Sample"" column to "Sample"
```{r Rename Analyte..Sample_ Column}
library(dplyr)
test2<- rename(test, Location=X.Location_, Sample=Analyte..Sample_)%>%
  filter(Sample!="")%>%
  select(-X_,-X.1_NA)
```

##Find analyte concentrations below and above the limit of detection, delete "<"", ">"", "↓" characters
```{r Eliminate <, >, ↓ from table}
test3<- data.frame(lapply(test2,function(x) {
  gsub("<|>|↓","", x)
}))
```
